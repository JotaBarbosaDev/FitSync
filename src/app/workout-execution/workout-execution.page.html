<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="confirmQuitWorkout()" fill="clear">
        <ion-icon name="close-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>{{ workout?.name || 'Treino' }}</ion-title>
    <ion-buttons slot="end" *ngIf="isWorkoutStarted && !isWorkoutCompleted">
      <ion-button (click)="pauseWorkout()" fill="clear" [color]="isWorkoutPaused ? 'success' : 'warning'">
        <ion-icon [name]="isWorkoutPaused ? 'play' : 'pause'" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">

  <!-- Tela Inicial - Antes de Come√ßar -->
  <div class="workout-intro" *ngIf="!isWorkoutStarted && workout">
    <div class="intro-header">
      <ion-icon name="fitness-outline" class="workout-icon"></ion-icon>
      <h1>{{ workout.name }}</h1>
      <p class="workout-description">{{ workout.description || 'Prepare-se para o treino!' }}</p>
    </div>

    <div class="workout-overview">
      <div class="overview-stats">
        <div class="stat-item">
          <ion-icon name="list-outline"></ion-icon>
          <span>{{ workout.exercises.length }} exerc√≠cios</span>
        </div>
        <div class="stat-item">
          <ion-icon name="time-outline"></ion-icon>
          <span>~{{ workout.estimatedDuration }} min</span>
        </div>
        <div class="stat-item">
          <ion-icon name="flame-outline"></ion-icon>
          <span>{{ workout.difficulty }}</span>
        </div>
      </div>

      <div class="exercises-preview">
        <h3>Exerc√≠cios</h3>
        <div class="exercises-list">
          <div class="exercise-preview" *ngFor="let exercise of workout.exercises; let i = index">
            <div class="exercise-number">{{ i + 1 }}</div>
            <div class="exercise-info">
              <div class="exercise-name">{{ exercise.name }}</div>
              <div class="exercise-details">{{ exercise.sets }} s√©ries ‚Ä¢ {{ exercise.reps }} reps</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="start-section">
      <ion-button 
        expand="block" 
        size="large" 
        (click)="startWorkout()"
        class="start-button">
        <ion-icon name="play" slot="start"></ion-icon>
        Come√ßar Treino
      </ion-button>
    </div>
  </div>

  <!-- Execu√ß√£o do Treino -->
  <div class="workout-execution" *ngIf="isWorkoutStarted && !isWorkoutCompleted">
    
    <!-- Barra de Progresso -->
    <div class="progress-section">
      <div class="progress-info">
        <span>Progresso do Treino</span>
        <span>{{ getWorkoutProgress().toFixed(0) }}%</span>
      </div>
      <ion-progress-bar [value]="getWorkoutProgress() / 100" color="primary"></ion-progress-bar>
    </div>

    <!-- Timer do Treino -->
    <div class="timer-section">
      <div class="workout-timer">
        <ion-icon name="time-outline"></ion-icon>
        <span>{{ formatDuration(workoutDuration) }}</span>
      </div>
      <div class="exercise-counter">
        Exerc√≠cio {{ currentExerciseIndex + 1 }} de {{ workout?.exercises.length }}
      </div>
    </div>

    <!-- Timer de Descanso -->
    <div class="rest-timer" *ngIf="isResting">
      <div class="rest-content">
        <ion-icon name="bed-outline" class="rest-icon"></ion-icon>
        <h2>Descanso</h2>
        <div class="rest-time">{{ formatRestTime(restTime) }}</div>
        <p>Relaxe e prepare-se para a pr√≥xima s√©rie</p>
        <ion-button fill="outline" (click)="skipRest()">
          <ion-icon name="play-skip-forward" slot="start"></ion-icon>
          Pular Descanso
        </ion-button>
      </div>
    </div>

    <!-- Exerc√≠cio Atual -->
    <div class="current-exercise" *ngIf="!isResting && getCurrentExercise()">
      <div class="exercise-header">
        <h2>{{ getCurrentExercise()?.name }}</h2>
        <div class="set-info">
          S√©rie {{ getCurrentSet() }} de {{ getTotalSets() }}
        </div>
      </div>

      <div class="exercise-details">
        <div class="detail-card">
          <ion-icon name="repeat-outline"></ion-icon>
          <div class="detail-content">
            <div class="detail-label">Repeti√ß√µes</div>
            <div class="detail-value">{{ getCurrentExercise()?.reps }}</div>
          </div>
        </div>

        <div class="detail-card" *ngIf="getCurrentExercise()?.weight">
          <ion-icon name="barbell-outline"></ion-icon>
          <div class="detail-content">
            <div class="detail-label">Peso</div>
            <div class="detail-value">{{ getCurrentExercise()?.weight }}kg</div>
          </div>
        </div>

        <div class="detail-card">
          <ion-icon name="timer-outline"></ion-icon>
          <div class="detail-content">
            <div class="detail-label">Descanso</div>
            <div class="detail-value">{{ getCurrentExercise()?.restTime }}</div>
          </div>
        </div>
      </div>

      <div class="exercise-instructions" *ngIf="getCurrentExercise()?.instructions">
        <h4>üìù Instru√ß√µes</h4>
        <p>{{ getCurrentExercise()?.instructions }}</p>
      </div>

      <div class="action-buttons">
        <ion-button 
          expand="block" 
          size="large" 
          (click)="showSetInputDialog()"
          class="complete-set-btn">
          <ion-icon name="checkmark" slot="start"></ion-icon>
          S√©rie Completa
        </ion-button>
      </div>
    </div>

  </div>

  <!-- Treino Conclu√≠do -->
  <div class="workout-completed" *ngIf="isWorkoutCompleted">
    <div class="completion-content">
      <ion-icon name="trophy-outline" class="trophy-icon"></ion-icon>
      <h1>Parab√©ns!</h1>
      <p>Voc√™ completou seu treino com sucesso!</p>
      
      <div class="completion-stats">
        <div class="stat-item">
          <ion-icon name="time-outline"></ion-icon>
          <div class="stat-content">
            <div class="stat-value">{{ formatDuration(workoutDuration) }}</div>
            <div class="stat-label">Dura√ß√£o</div>
          </div>
        </div>
        <div class="stat-item">
          <ion-icon name="fitness-outline"></ion-icon>
          <div class="stat-content">
            <div class="stat-value">{{ workout?.exercises.length }}</div>
            <div class="stat-label">Exerc√≠cios</div>
          </div>
        </div>
      </div>

      <div class="completion-actions">
        <ion-button 
          expand="block" 
          fill="solid" 
          (click)="router.navigate(['/workout-progress'])"
          class="action-btn">
          <ion-icon name="stats-chart" slot="start"></ion-icon>
          Ver Progresso
        </ion-button>
        
        <ion-button 
          expand="block" 
          fill="outline" 
          (click)="router.navigate(['/workout-management'])"
          class="action-btn">
          <ion-icon name="home" slot="start"></ion-icon>
          Voltar ao In√≠cio
        </ion-button>
      </div>
    </div>
  </div>

  <!-- Estado de Pausa -->
  <div class="pause-overlay" *ngIf="isWorkoutPaused && isWorkoutStarted && !isWorkoutCompleted">
    <div class="pause-content">
      <ion-icon name="pause-circle-outline" class="pause-icon"></ion-icon>
      <h2>Treino Pausado</h2>
      <p>Toque em play para continuar</p>
    </div>
  </div>

</ion-content>
